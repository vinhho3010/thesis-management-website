<div class="table-wrapper form-shadow rounded">
  <div class="table-responsive">
    <table mat-table matSort [dataSource]="dataSource">
      <ng-container *ngFor="let column of columns" [matColumnDef]="column.key">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="custom-cell"> {{ column.header }} </th>
        <td mat-cell *matCellDef="let row" class="custom-cell">
          <ng-container *ngIf="column.type === 'text'; else dateOrBoolean">
            <div class="mobile-label">
              {{ column.header }}
            </div>
            {{ row[column.key] }}
          </ng-container>

          <ng-template #dateOrBoolean>
            <div *ngIf="column.type === 'date'; else booleanValue">
              <div class="mobile-label">
                {{ column.header }}
              </div>
              {{ row[column.key] | date: 'MM/dd/yyyy HH:mm'}}
            </div>

            <ng-template #booleanValue>
              <div class="mobile-label">
                {{ column.header }}
              </div>
              <mat-icon *ngIf="row[column.key]">check</mat-icon>
            </ng-template>
          </ng-template>
        </td>
      </ng-container>

      <ng-container matColumnDef="actions" class="actions-column">
        <th mat-header-cell *matHeaderCellDef class="custom-actions-cell">Actions</th>
        <td mat-cell *matCellDef="let row">
          <div class="button-wrapper" *ngIf="!row?.archived">
            <ng-container *ngFor="let action of actions">
              <button *ngIf="row?.surgeryPerformed && (action.icon==='archive' || action.icon==='edit')" mat-mini-fab
                [color]="action.color"
                (click)="action.action(row)"
                [matTooltip]="action.tooltip"
                [matTooltipShowDelay]="150">
                  <mat-icon class="scale-70">{{ action.icon }}</mat-icon>
              </button>
              <button *ngIf="!row?.surgeryPerformed && action.icon!=='archive'" mat-mini-fab
                [color]="action.color"
                (click)="action.action(row)"
                [matTooltip]="action.tooltip"
                [matTooltipShowDelay]="150">
                  <mat-icon class="scale-70">{{ action.icon }}</mat-icon>
              </button>
            </ng-container>
          </div>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"
        [class.archived-item]="row.archived"
        ></tr>
      <tr class="text-center" *matNoDataRow>
        <td class="mat-cell py-4" colspan="10" *ngIf="dataSource?.data?.length === 0">No data found</td>
      </tr>
    </table>
    <mat-paginator
      [pageSizeOptions]="[5, 10, 25, 100]"
      [pageSize]="pagination.pageSize"
      [pageIndex]="pagination.page"
      [length]="pagination.totalRecords"
      (page)="onPageChange($event)"
      showFirstLastButtons
    ></mat-paginator>
  </div>
</div>
